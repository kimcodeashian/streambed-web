<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, shrink-to-fit=no"
    />
    <meta name="description" content="" />
    <meta name="author" content="" />

    <title>Streambed Media - Indexing Page</title>

    <!-- Bootstrap core CSS -->
    <link href="/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet" />

    <!-- Custom fonts for this template -->
    <link href="/vendor/fontawesome-free/css/all.min.css" rel="stylesheet" />
    <link
      href="/vendor/simple-line-icons/css/simple-line-icons.css"
      rel="stylesheet"
      type="text/css"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600&family=Nunito:wght@700;800&display=swap"
      rel="stylesheet"
    />

    <!-- Custom styles for this template -->
    <link href="/css/landing-page.css" rel="stylesheet" />
    <link href="/css/content-page.css" rel="stylesheet" />
  </head>
  <body>
    <!-- Navigation -->
    <nav class="navbar navbar-dark navbar-expand-lg sticky-top streamNavBar">
      <div class="container">
        <a class="navbar-brand" href="#" style="background-color: transparent;"
          ><img  src="/img/logo.svg" alt="Streambed Logo"
        /></a>
        <button
          class="navbar-toggler streamToggler"
          type="button"
          data-toggle="collapse"
          data-target="#navbarItems"
          aria-controls="navbarItems"
          aria-expanded="false"
          aria-label="Toggle navigation"
        >
          <span class="navbar-toggler-icon">
            <i class="fas fa-bars" style="color: #fff; font-size: 1.5em;"></i>
          </span>
        </button>

        <div class="collapse navbar-collapse" id="navbarItems">
          <ul class="navbar-nav mr-auto">
            <li class="nav-item">
              <a class="nav-link ml-md-5" href="/index"
                >Home<span class="sr-only">(current)</span></a
              >
            </li>
            <li class="nav-item">
              <a class="nav-link ml-md-5" href="/about">About</a>
            </li>
          </ul>
          <a class="btn btn-primary streamButton streamTransparent" href="/subscribe">SUBSCRIBE</a>
        </div>
      </div>
    </nav>
    <div class="container">
      <!--Content Section-->

      <section class="bg-white mt-0 mb-0 streamGreen">
        <div class="container">
          <div class="row">
            <!-- First content column  -->
            <div class="col-xs-12 col-md-8 mt-5 mb-5">
              <div class="videoPlaceholder">
                <div class="embed-responsive embed-responsive-16by9">
                  <iframe class="embed-responsive-item" src="" allowfullscreen></iframe>
                </div>
              </div>
              <section class="videoInfoSection mt-3">
                <h2>
                </h2>
                <div class="d-flex justify-content-between videoDetails">
                  <span class="date"></span>
                  <span class="time"></span>
                  <span></span>
                </div>
              </section>
              <section id="originalVideo">

                <!-- Orginal Video -->
                <h4>Original Content</h4>
                <div class="d-flex flex-row mt-4">
                  <div class="d-flex flex-column">
                    <div class="videoPlaceholderSmall">
                      <div class="embed-responsive embed-responsive-16by9">
                        <iframe class="embed-responsive-item" src="" allowfullscreen></iframe>
                      </div>
                    </div>
                    <!-- Placeholder image for video -->
                  </div>

                  <div
                    class="d-flex flex-column ml-sm-4 flex-wrap videoDetails"
                  >
                    <p class="title">
                    </p>
                    <p class="date"></p>
                    <p class="time"></p>
                  </div>
                </div>

                <!-- Here's the proof section -->
              </section>
              <section
                class="d-flex justify-content-center flex-column align-items-center mt-3"
              >
                <p class="text-center font-weight-bold">
                  Want to know more?
                </p>
                <div>
                  <a
                    class="btn btn-primary streamButton"
                    href="http://network.flo.cash"
                    target="_blank"
                    >HERE'S THE PROOF</a
                  >
                </div>
              </section>

              <!-- Collaborators section - currently has placeholder images -->
              <div id="collaborators" class="mt-4">
                <h4 class="mb-4">Collaborators</h4>
                <div>
                  <h5 class="text-center m-auto pb-5" id="nothing-text">
                    Nothing to show here.
                   </h5>
                  <div
                    class="MultiCarousel"
                    data-items="1,3,5,6"
                    data-slide="1"
                    id="MultiCarousel"
                    data-interval="200"
                  >
                    <div class="MultiCarousel-inner" id="collaborator-slider">
                    
                    </div>
                    <div class="leftLst"><i class="fas fa-chevron-left fa-2x"></i></div>
                    <div class="rightLst"><i class="fas fa-chevron-right fa-2x"></i></div>
                  </div>  
                </div>
              </div>
            

              <!-- Activity feed section - currently using placeholder images -->
              <div id="activityFeed">
                <h4>Video Activity Feed</h4>

                <div class="container indexBorder mt-4 activity-feed-row">
                  <div class="d-flex flex-row justify-content-between mt-3 mb-4 activity-row">
                      <h5 class="text-center mx-auto">Nothing to show here</h5>
                  </div>
                </div>
              </div>


              <div class="d-flex flex-row justify-content-center mt-5">
                <div class="d-flex flex-column justify-content-center">
                  <a
                    class="btn btn-primary streamButton"
                    href="https://concept.streambedmedia.com/"
                    target="_blank"
                    >SIGN IN TO SEE MORE</a
                  >
                </div>
              </div>
            </div>
            <!-- Published by section - placeholder used for user icon -->
            <div class="col-xs-12 col-md-4 mb-5 mt-sm-5">
              <div class="container indexBorder pb-4">
                <p class="text-center mt-4 grey">Published By:</p>
                <div class="d-flex justify-content-center">
                  <i class="fas fa-user-circle fa-7x mt-2 mb-3 streamGrey"></i>
                </div>
                <h5 class="text-center" id="displayName"></h5>
                <p class="text-center grey mb-0" id="userSince" >User Since:</p>
                <p class="text-center" id="memberSince"></p>
              </div>

              <!-- App info and links sections - need the links -->
              <div class="container indexBorder mt-5 pb-4">
                <h5 class="text-center pt-4">
                  Want to use this video somewhere else?
                </h5>
                <p class="text-center grey">
                  The creator says you can, as long as you use Streambed when
                  you post it to your favorite social channel. (Don’t worry,
                  it’s free! <b>Always.</b>)
                </p>
                <p class="text-center grey">
                  Streambed will let everyone know, then we can all help make it
                  a hit!
                </p>

                <div class="d-flex justify-content-center">
                  <a
                    class="btn btn-primary streamButton"
                    href="https://concept.streambedmedia.com/"
                    target="_blank"
                    >START LINKING</a
                  >
                </div>
              </div>
              <div class="container indexBorder mt-5 p-5 streamLinks">
                <p class="text-center">
                  <a
                    class="indexLinks"
                    href="https://www.youtube.com/watch?v=BbfWRkrXNu4&feature=emb_title"
                    target="_blank"
                    >What is this app?</a
                  >
                </p>
                <p class="text-center">
                  <a class="indexLinks" href="/subscribe">Something Missing?</a>
                </p>
                <p class="text-center">
                  <a
                    class="indexLinks"
                    href="#streamFeatureModal"
                    data-toggle="modal"
                    data-target="#streamFeatureModal"
                    >Is it you in this video?</a
                  >
                </p>
                <p class="text-center mb-0">
                  <a
                    class="indexLinks"
                    href="https://concept.streambedmedia.com/"
                    target="_blank"
                    >Sign up to see more</a
                  >
                </p>
              </div>
            </div>
          </div>
        </div>

        <!-- Feature not ready pop up -->
        <div
          class="modal fade"
          id="streamFeatureModal"
          tabindex="-1"
          role="dialog"
          aria-labelledby="streamFeatureModal"
          aria-hidden="true"
        >
          <div class="modal-dialog modal-dialog-centered" role="document">
            <div class="modal-content">
              <div class="modal-header streamModalTitle">
                <h5 class="modal-title" id="streamVideo"></h5>
                <button
                  type="button"
                  class="close"
                  data-dismiss="modal"
                  aria-label="Close"
                >
                  <span aria-hidden="true">&times;</span>
                </button>
              </div>

              <div class="modal-body p-sm-5">
                <p>
                  We’re still working on this feature! Contact the creator
                  listed here and ask them to add you as a collaborator.
                </p>
              </div>
            </div>
          </div>
        </div>
      </section>
    </div>
    <!-- Footer -->
    <footer class="footer bg-StreamGreen">
      <div class="container">
        <div class="row">
          <div class="col-lg-5">
            <img class="mb-2" src="/img/logo.svg" alt="Streambed logo" />
            <p class="text-white">Peterborough | New York</p>
          </div>
          <div class="col-md-2">
            <h5 class="text-white streamFooterTitle">COMPANY</h5>
            <div class="list-group">
              <a href="/index" class="text-white streamFooterList">HOME</a>
              <a href="/about" class="text-white streamFooterList">ABOUT</a>
              <a href="/subscribe" class="text-white streamFooterList"
                >SUBSCRIBE</a
              >
            </div>
          </div>

          <div class="col-md-2">
            <h5 class="text-white streamFooterTitle">LEGAL</h5>
            <div class="list-group">
              <a href="/terms" class="text-white streamFooterList"
                >TERMS OF SERVICE</a
              >
              <a href="/privacy" class="text-white streamFooterList">PRIVACY</a>
            </div>
          </div>

          <div class="col-md-3">
            <h5 class="text-white streamFooterTitle">FOLLOW US</h5>
            <ul class="list-inline mb-0">
              <li class="list-inline-item mr-2">
                <a href="https://www.facebook.com/thestreambed" target="_blank">
                  <i class="fab fa-facebook-square fa-2x fa-fw streamFab"></i>
                </a>
              </li>
              <li class="list-inline-item mr-2">
                <a href="http://twitter.com/streambedmedia" target="_blank">
                  <i class="fab fa-twitter-square fa-2x fa-fw streamFab"></i>
                </a>
              </li>
              <li class="list-inline-item">
                <a
                  href="http://www.instagram.com/streambedmedia"
                  target="_blank"
                >
                  <i class="fab fa-instagram fa-2x fa-fw streamFab"></i>
                </a>
              </li>
            </ul>
            <p class="text-white mt-2">INFO@STREAMBEDMEDIA.COM</p>
          </div>
        </div>
        <div class="row">
          <div class="col-sm-6">
            <p class="text-white small mb-4 mb-lg-0 mt-3">
              &copy; All rights Reserved Streambed Media Inc 2020
            </p>
          </div>
        </div>
      </div>
    </footer>
    <!-- Bootstrap core JavaScript -->
    <script src="/vendor/jquery/jquery.min.js"></script>
    <script src="/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>

    <script>
      String.prototype.toHHMMSS = function () {
    var sec_num = parseInt(this, 10); // don't forget the second param
    var hours   = Math.floor(sec_num / 3600);
    var minutes = Math.floor((sec_num - (hours * 3600)) / 60);
    var seconds = sec_num - (hours * 3600) - (minutes * 60);

    if (hours   < 10) {hours   = "0"+hours;}
    if (minutes < 10) {minutes = "0"+minutes;}
    if (seconds < 10) {seconds = "0"+seconds;}
    return hours+':'+minutes+':'+seconds;
}
      $(document).ready(function () {
        const path = window.location.pathname.replace(/\/content\//, "")

        if(!path || path === "/content") {
          window.location.replace("/index")
        } 

        fetch(
          "https://app.streambedmedia.com/posts/video?content_id=" + path
        )
          .then((resp) => resp.json())
          .then(function (data) {
            console.log(data, data.userId.displayName)
            $("#displayName").append(data.userId.displayName);
            if(data.userId.memberSince){
              $("#memberSince").append(data.userId.memberSince);
            } else {
              $("#userSince").remove()
            }
            $('.videoPlaceholder iframe').attr("src", "https://www.youtube.com/embed/" + (data.youtubeId || {}).videoId);
            $(".videoInfoSection h2").append((data.youtubeId || {}).title);
            $(".videoInfoSection .videoDetails .date").append(new Date(data.dateCreated).toDateString());
            $(".videoInfoSection .videoDetails .time").append((data.videoLength || 0).toString().toHHMMSS());
            $("#originalVideo .title").append(data.title);
            $("#originalVideo .time").append((data.videoLength || 0).toString().toHHMMSS());
            $("#originalVideo .date").append(new Date(data.dateCreated).toDateString());
            $('.videoPlaceholderSmall iframe').attr("src", "https://app.streambedmedia.com/" + data.videoPath);
            

            $('.activity-row').remove();
            $.each(data.activityFeed, function(index,activity) {
                $(".activity-feed-row").append('<div class="d-flex flex-row justify-content-between mt-3 mb-4 activity-row"><div class="align-items-center d-flex flex-row" ><div class="d-flex flex-column justify-content-center"><i class="fas fa-user-circle fa-4x text-center streamGrey mb-0"></i></div> <div class="ml-4"> <p class="mb-0 streamGrey"> <b class="streamGreen">'+ activity.userId.displayName +'</b> posted a video to <b class="streamGreen text-capitalize">'+activity.platform+'.</b> </p> <div class="d-flex justify-content-between streamGrey"> <span>'+new Date(activity.dateCreated).toDateString()+'</span> <span>'+new Date(activity.dateCreated).toLocaleTimeString()+'</span> </div> </div> </div> <div class="d-flex flex-column justify-content-center"> <a class="btn btn-primary streamButton activityFeedButton ml-0" href="/content/'+activity.userVideoId._id+'" >CHECK IT OUT</a></div></div>')
            })
            var collab = [...data.collaborators]
            collab.sort(function(a,b){return b.isVerified-a.isVerified});  
            if(collab && collab.length > 0) $("#nothing-text").remove()
            $.each(collab, function(index,collaborator) {
              var name = collaborator.isVerified ? (collaborator.userId || {}).displayName : 'Unverified'
              var className = collaborator.isVerified ? 'streamGreen' : 'streamPurple'
              var status =  collaborator.isVerified ? 'Verified' : 'Unverified'
              var icon = collaborator.isVerified ? 'fa-check-circle' : 'fa-times-circle'

            $("#collaborator-slider").append('<div class="item"><div class="d-flex flex-column justify-content-center"> <div class="position-relative"> <i class="fas fa-user-circle fa-5x text-center mb-0 streamGrey" ></i ><i class="fas text-right '+icon+' fa-lg '+className+' checkIcon" ></i> </div> <h5 class="streamGreen text-center mt-2 mb-1">'+ name +'</h5> <p class="streamGrey text-center">'+ collaborator.role +'</p> <p class="' + className + ' text-center">'+ status +'</p></div></div>')
            })
            ResCarouselSize();
            });
      
        var itemsMainDiv = ".MultiCarousel";
        var itemsDiv = ".MultiCarousel-inner";
        var itemWidth = "";

        $(".leftLst, .rightLst").click(function () {
          var condition = $(this).hasClass("leftLst");
          if (condition) click(0, this);
          else click(1, this);
        });

        ResCarouselSize();

        $(window).resize(function () {
          ResCarouselSize();
        });

        //this function define the size of the items
        function ResCarouselSize() {
          var incno = 0;
          var dataItems = "data-items";
          var itemClass = ".item";
          var id = 0;
          var btnParentSb = "";
          var itemsSplit = "";
          var sampwidth = $(itemsMainDiv).width();
          var bodyWidth = $("body").width();
          $(itemsDiv).each(function () {
            id = id + 1;
            var itemNumbers = $(this).find(itemClass).length;
            btnParentSb = $(this).parent().attr(dataItems);
            itemsSplit = btnParentSb.split(",");
            $(this)
              .parent()
              .attr("id", "MultiCarousel" + id);

            itemWidth = 280;

            $(this).css({
              transform: "translateX(0px)",
              width: itemWidth * itemNumbers,
            });
            $(this)
              .find(itemClass)
              .each(function () {
                $(this).outerWidth(itemWidth);
              });

            $(".leftLst").addClass("over");
            $(".rightLst").removeClass("over");
          });
        }

        //this function used to move the items
        function ResCarousel(e, el, s) {
          var leftBtn = ".leftLst";
          var rightBtn = ".rightLst";
          var translateXval = "";
          var divStyle = $(el + " " + itemsDiv).css("transform");
          var values = divStyle.match(/-?[\d\.]+/g);
          var xds = Math.abs(values[4]);
          if (e == 0) {
            translateXval = parseInt(xds) - parseInt(itemWidth * s);
            $(el + " " + rightBtn).removeClass("over");

            if (translateXval <= itemWidth / 2) {
              translateXval = 0;
              $(el + " " + leftBtn).addClass("over");
            }
          } else if (e == 1) {
            var itemsCondition = $(el).find(itemsDiv).width() - $(el).width();
            translateXval = parseInt(xds) + parseInt(itemWidth * s);
            $(el + " " + leftBtn).removeClass("over");

            if (translateXval >= itemsCondition - itemWidth / 2) {
              translateXval = itemsCondition;
              $(el + " " + rightBtn).addClass("over");
            }
          }
          $(el + " " + itemsDiv).css(
            "transform",
            "translateX(" + -translateXval + "px)"
          );
        }

        //It is used to get some elements from btn
        function click(ell, ee) {
          var Parent = "#" + $(ee).parent().attr("id");
          var slide = $(Parent).attr("data-slide");
          ResCarousel(ell, Parent, slide);
        }
      });
    </script>
  </body>
</html>
